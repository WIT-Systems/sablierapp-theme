<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="robots" content="noindex, nofollow" />
    <title>Sablier | Starting App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta http-equiv="refresh" content="{{ .RefreshFrequency }}" />
    <link rel="preconnect" href="https://fonts.bunny.net" crossorigin>
    <link href="https://fonts.bunny.net/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --brand-orange: #fe4400;
            --brand-dark: #3f3834;
            --bg-gradient: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --error-red: #dc3545;
            --success-green: #28a745;
        }

        html, body {
            font-family: 'Open Sans', sans-serif;
            min-height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-gradient);
            color: #333;
            padding: 20px;
        }

        .container {
            display: flex;
            align-items: stretch;
            /* Container will now expand to fit content width */
            width: fit-content;
            min-width: 450px;
            max-width: 95vw; 
            background: #ffffff;
            padding: 40px;
            border-radius: 20px;
            box-shadow: var(--card-shadow);
            box-sizing: border-box;
        }

        .logocontainer {
            display: flex;
            justify-content: center;
            align-items: center;
            padding-right: 40px;
            flex-shrink: 0;
        }

        .logocontainer svg {
            width: 180px;
            height: auto;
            animation: breathe 4s ease-in-out infinite;
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.04); }
        }

        .divider {
            width: 1px;
            background-color: #eee;
            margin-right: 40px;
            flex-shrink: 0;
        }

        .text-container {
            flex: 1;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .title {
            margin: 0;
            font-size: 26px;
            font-weight: 700;
            color: var(--brand-dark);
            white-space: nowrap;
        }

        .description {
            font-size: 14px;
            color: #888;
            margin: 8px 0 24px 0;
        }

        /* Table Styling */
        .details table {
            border-collapse: collapse;
            width: 100%;
        }

        .details tr {
            border-bottom: 1px solid #f8f9fa;
        }

        .details td {
            padding: 12px 0;
        }

        /* Name Cell Logic */
        .name-cell {
            display: flex;
            align-items: flex-start;
            padding-right: 30px; /* Space between name and status count */
        }

        .status-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            margin-top: 2px;
            flex-shrink: 0;
        }

        .icon-error { fill: var(--error-red); }
        .icon-success { fill: var(--success-green); }
        .icon-pending {
            fill: var(--brand-orange);
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.85); }
            100% { opacity: 1; transform: scale(1); }
        }

        .status-content {
            display: flex;
            flex-direction: column;
            min-width: 0;
        }

        .instance-name {
            font-weight: 600;
            font-size: 15px;
            color: var(--brand-dark);
            /* Only wraps if it hits the max-width of the card */
            word-break: break-word; 
        }

        .error-title {
            color: var(--error-red);
            font-weight: 600;
            font-size: 15px;
        }

        .error-msg {
            color: #a35d5d;
            font-size: 12px;
            line-height: 1.4;
            margin-top: 2px;
        }

        /* Status Count Logic */
        .status-count {
            text-align: right;
            font-size: 13px;
            color: #666;
            white-space: nowrap; /* Keeps "(0/1)" on one line */
            vertical-align: top;
            padding-top: 14px !important;
        }

        /* Mobile Adjustments */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                width: 100%;
                min-width: 0;
                padding: 30px;
                align-items: center;
                text-align: center;
            }
            .logocontainer {
                padding-right: 0;
                margin-bottom: 20px;
            }
            .divider { display: none; }
            .name-cell { justify-content: center; padding-right: 0; }
            .status-count {
                text-align: center;
                display: block;
                padding-top: 4px !important;
                margin-bottom: 10px;
            }
            .title { white-space: normal; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="logocontainer">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="109.43 344.37 725.07 310.27">
            <g><path fill="#3f3834" d="M 109.5,344.5 C 139.5,344.5 169.5,344.5 199.5,344.5C 213.192,402.933 227.358,461.266 242,519.5C 255.667,461.5 269.333,403.5 283,345.5C 308.426,344.505 333.926,344.172 359.5,344.5C 374.186,402.578 389.186,460.578 404.5,518.5C 419.109,460.96 433.276,403.293 447,345.5C 471.768,344.173 496.601,344.173 521.5,345.5C 494.008,448.47 466.674,551.47 439.5,654.5C 412.167,654.5 384.833,654.5 357.5,654.5C 344.128,599.011 330.128,543.678 315.5,488.5C 301.786,543.737 288.452,599.071 275.5,654.5C 247.159,654.833 218.825,654.5 190.5,653.5C 163.668,552.839 136.835,452.172 110,351.5 C 109.503,349.19 109.337,346.857 109.5,344.5 Z"></path></g>
            <g><path fill="#fe4400" d="M 592.5,432.5 C 562.833,431.833 533.167,431.167 503.5,430.5 C 510.696,402.049 518.363,373.716 526.5,345.5 C 556.493,344.5 586.493,344.167 616.5,344.5 C 609.102,374.101 601.102,403.434 592.5,432.5 Z"></path></g>
            <g><path fill="#403834" d="M 621.5,344.5 C 692.5,344.5 763.5,344.5 834.5,344.5 C 830.091,369.547 825.424,394.547 820.5,419.5 C 800.831,419.333 781.164,419.5 761.5,420 C 762.498,498.096 762.832,576.263 762.5,654.5 C 731.833,654.5 701.167,654.5 670.5,654.5 C 670.5,576.167 670.5,497.833 670.5,419.5 C 647.5,419.5 624.5,419.5 601.5,419.5 C 607.766,394.372 614.433,369.372 621.5,344.5 Z"></path></g>
            <g><path fill="#3f3835" d="M 502.5,432.5 C 532.5,432.5 562.5,432.5 592.5,432.5 C 573.14,506.272 553.307,579.939 533,653.5 C 502.9,654.828 472.733,654.828 442.5,653.5 C 462.659,579.864 482.659,506.198 502.5,432.5 Z"></path></g>
        </svg>
    </div>

    <div class="divider"></div>

    <div class="text-container">
        <h3 class="title">Starting {{ .DisplayName }}</h3>
        <p class="description">Automatic shutdown after {{ .SessionDuration }} of inactivity.</p>
        
        <div class="details">
            <table>
                {{- range $i, $instance := .InstanceStates }}
                <tr>
                    <td class="name-cell">
                        {{- if $instance.Error }}
                        <svg class="status-icon icon-error" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                        <div class="status-content">
                            <span class="error-title">Instance Error</span>
                            <span class="error-msg">{{ $instance.Error }}</span>
                        </div>
                        {{- else }}
                        {{- if ne $instance.CurrentReplicas $instance.DesiredReplicas }}
                        <svg class="status-icon icon-pending" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
                        {{- else }}
                        <svg class="status-icon icon-success" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                        {{- end }}
                        <div class="status-content">
                            <span class="instance-name">{{ $instance.Name }}</span>
                        </div>
                        {{- end }}
                    </td>
                    <td class="status-count">
                        {{- if not $instance.Error }}
                        {{ $instance.Status }} ({{ $instance.CurrentReplicas }}/{{ $instance.DesiredReplicas }})
                        {{- else }}
                        <span style="color: var(--error-red); font-weight: 600;">Failed</span>
                        {{- end }}
                    </td>
                </tr>
                {{- end -}}
            </table>
        </div>
    </div>
</div>

</body>
</html>
